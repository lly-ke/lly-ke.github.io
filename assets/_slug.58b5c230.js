var T=(s,n,d)=>new Promise((x,w)=>{var h=o=>{try{r(d.next(o))}catch(a){w(a)}},U=o=>{try{r(d.throw(o))}catch(a){w(a)}},r=o=>o.done?x(o.value):Promise.resolve(o.value).then(h,U);r((d=d.apply(s,n)).next())});import{s as O,b as q,r as z,o as c,e as u,g,w as C,f as t,i,t as _,h as l,F as D,B as j,n as E,a as G,u as H,l as V,q as I,v as P,C as J,D as K,x as Q,E as X}from"./vendor.e80f1292.js";import{u as W,a as Y,d as Z,g as tt,c as B,b as et,e as st}from"./index.d750e11f.js";import{u as ot}from"./follwing.888d1de0.js";const at={class:"article-meta"},lt=["src"],nt={class:"info"},it={class:"date"},rt={key:0,"ng-show":"$ctrl.canModify",class:"ng-scope"},ct=t("i",{class:"ion-edit"},null,-1),ut=i(" Edit Article "),dt=t("i",{class:"ion-trash-a"},null,-1),ht=i(" Delete Article "),_t=[dt,ht],mt=t("i",{class:"ion-plus-round"},null,-1),ft=i(" \xA0\xA0 "),vt=t("i",{class:"ion-heart"},null,-1),gt=i(" \xA0 "),bt={class:"counter"},M={props:["article"],setup(s){let n=W(),{isLogin:d,userInfo:x}=O(n),w=q();const h=()=>{Z(s.article.slug).then(()=>{w.push("/")})};return(U,r)=>{var a,R,S,m,$,f,k,e,p,A,F,v,L;const o=z("router-link");return c(),u("div",at,[g(o,{to:`/user/profile/${(R=(a=s.article)==null?void 0:a.author)==null?void 0:R.username}`},{default:C(()=>{var y,b;return[t("img",{src:(b=(y=s.article)==null?void 0:y.author)==null?void 0:b.image},null,8,lt)]}),_:1},8,["to"]),t("div",nt,[g(o,{to:`/user/profile/${(m=(S=s.article)==null?void 0:S.author)==null?void 0:m.username}`,class:"author"},{default:C(()=>{var y,b;return[i(_((b=(y=s.article)==null?void 0:y.author)==null?void 0:b.username),1)]}),_:1},8,["to"]),t("span",it,_(s.article.createdAt),1)]),((f=($=s.article)==null?void 0:$.author)==null?void 0:f.username)===((k=l(x))==null?void 0:k.username)?(c(),u("span",rt,[g(o,{class:"btn btn-outline-secondary btn-sm mr-2",to:`/article/editor/${s.article.slug}`},{default:C(()=>[ct,ut]),_:1},8,["to"]),t("button",{class:"btn btn-outline-danger btn-sm",onClick:h},_t)])):(c(),u(D,{key:1},[t("button",{onClick:r[0]||(r[0]=y=>{var b,N;return l(ot)(j((b=s.article)==null?void 0:b.author).following,(N=s.article.author)==null?void 0:N.username)}),class:E(["btn btn-sm",((p=(e=s.article)==null?void 0:e.author)==null?void 0:p.following)?"btn-secondary":"btn-outline-secondary"])},[mt,i(" \xA0 "+_(`${((F=(A=s.article)==null?void 0:A.author)==null?void 0:F.following)?"Unfollow":"Follow"} ${(L=(v=s.article)==null?void 0:v.author)==null?void 0:L.username}`),1)],2),ft,t("button",{onClick:r[1]||(r[1]=y=>l(Y)(s.article)),class:E(["btn btn-sm",s.article.favorited?"btn-primary":"btn-outline-primary"])},[vt,gt,t("span",bt,_(`${s.article.favorited?"Unfavorite Post":"Favorite Post"}
                 (${s.article.favoritesCount})`),1)],2)],64))])}}},$t={class:"article-page"},kt={class:"banner"},yt={class:"container"},Ct={class:"container page"},wt={class:"row article-content"},xt={class:"col-md-12"},pt={class:"tag-list"},At=t("hr",null,null,-1),Ft={class:"article-actions"},Ut={class:"row"},Rt={class:"col-xs-12 col-md-8 offset-md-2"},St={key:0,class:"card comment-form"},Vt={class:"card-block"},Bt={class:"card-footer"},Dt=["src"],Lt={key:1},Nt=i("Sign"),Tt=i(" in or "),Et=i("sign up"),It=i(" to add comments on this article. "),Pt={class:"card-block"},Mt={class:"card-text"},Ot={class:"card-footer"},qt=["src"],zt=i(" \xA0 "),Wt={class:"date-posted"},jt={class:"mod-options"},Gt=["onClick"],Xt=G({setup(s){return T(this,null,function*(){let n,d,x=H();q();let w=W(),h=x.params.slug,{isLogin:U,userInfo:r}=O(w),o=V([]),a=V("");const R=()=>{if(!a.value)return;let $={comment:{body:a.value}};et(h,$).then(()=>{B(h).then(f=>{o.value=f.data.comments,a.value=""})})},S=$=>{st(h,$).then(()=>{B(h).then(f=>{o.value=f.data.comments})})};let m=V({});return m.value=([n,d]=I(()=>tt(h)),n=yield n,d(),n).data.article,o.value=([n,d]=I(()=>B(h)),n=yield n,d(),n).data.comments,($,f)=>{const k=z("router-link");return c(),u("div",$t,[t("div",kt,[t("div",yt,[t("h1",null,_(l(m).title),1),g(M,{article:l(m)},null,8,["article"])])]),t("div",Ct,[t("div",wt,[t("div",xt,[t("div",null,_(l(m).body),1),t("ul",pt,[(c(!0),u(D,null,P(l(m).tagList,e=>(c(),u("li",{key:e,class:"tag-default tag-pill tag-outline"},_(e),1))),128))])])]),At,t("div",Ft,[g(M,{article:l(m)},null,8,["article"])]),t("div",Ut,[t("div",Rt,[l(U)?(c(),u("form",St,[t("div",Vt,[J(t("textarea",{class:"form-control",placeholder:"Write a comment...",rows:"3","onUpdate:modelValue":f[0]||(f[0]=e=>Q(a)?a.value=e:a=e)},null,512),[[K,l(a)]])]),t("div",Bt,[t("img",{src:l(r).image,class:"comment-author-img"},null,8,Dt),t("button",{onClick:R,class:"btn btn-sm btn-primary"}," Post Comment ")])])):(c(),u("p",Lt,[g(k,{to:"/user/login"},{default:C(()=>[Nt]),_:1}),Tt,g(k,{to:"/user/register"},{default:C(()=>[Et]),_:1}),It])),(c(!0),u(D,null,P(l(o),e=>{var p,A,F;return c(),u("div",{class:"card",key:e},[t("div",Pt,[t("p",Mt,_(e.body),1)]),t("div",Ot,[g(k,{to:`/user/profile/${(p=e.author)==null?void 0:p.username}`,class:"comment-author"},{default:C(()=>{var v;return[t("img",{src:(v=e==null?void 0:e.author)==null?void 0:v.image,class:"comment-author-img"},null,8,qt)]}),_:2},1032,["to"]),zt,g(k,{to:`/user/profile/${(A=e.author)==null?void 0:A.username}`,class:"comment-author"},{default:C(()=>{var v;return[i(_((v=e==null?void 0:e.author)==null?void 0:v.username),1)]}),_:2},1032,["to"]),t("span",Wt,_(e.createdAt),1),t("span",jt,[(e==null?void 0:e.author.username)===((F=l(r))==null?void 0:F.username)?(c(),u("i",{key:0,class:"ion-trash-a",onClick:v=>S(e.id)},null,8,Gt)):X("",!0)])])])}),128))])])])])}})}});export{Xt as default};
